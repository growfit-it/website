---
import { API_BASE_URL } from '../../config/api';

const { language = "fi" } = Astro.props;
const response = await fetch(`${API_BASE_URL}/api/heroes?filters[NameId][$eq]=LandingPage-Hero&pagination[limit]=1&populate[autoplay_video]=true&populate[ButtonGroup]=true&populate[BlogPosts][populate]=BlogPostPicture&locale=${language}`);
const data = await response.json();
const { title, highlighted_word, autoplay_video, BlogPosts, ButtonGroup } = data.data[0];


---

<section class="pt-32 pb-20 bg-white-ish">
  <div class="container mx-auto px-6">
    <div class="flex flex-col xl:flex-row items-center">
      <!-- 1st column: title + blog posts -->
      <div class="xl:w-1/3 w-full">
        <!-- Titles + Call-to-action -->
        <div class="mt-0 text-center mb-4 xl:mt-[67px]  xl:w-[410px] xl:h-[158px] xl:text-left" style="overflow:hidden;font-family: Coolvetica;font-weight: 400;font-size: 42px;line-height: 125%;color:#333333;" >
          {title} <span class="text-secondary" style="font-family: 'Helvetica Neue'">{highlighted_word}</span>
        </div>
        <!-- BUTTON GROUP -->
        <div class="flex gap-4 mb-16 xl:justify-start justify-center">
          {ButtonGroup.map((button) => (
            <a 
              href={button.ButtonURL} 
              class={`h-[36px] rounded-full px-8 inline-flex items-center transition-colors ${
                button.ButtonType === 'primary' 
                  ? 'bg-secondary text-white hover:bg-secondary/90' 
                  : 'border-2 border-[#ccd8e5] text-primary hover:bg-primary/5'
              }`} 
              style="font-size: 14px"
            >
              {button.ButtonLabel}
            </a>
          ))}          
        </div>

        <!-- Blog Posts -->
        <div class="hidden xl:block bg-primary-faded p-6 h-[284px] w-[418px] rounded-xl" style="overflow-x:hidden; overflow-y:hidden">
          <div class="space-y-3">
            {BlogPosts.map((post) => (
              <div class="flex items-center gap-x-4">
                <div class="w-[94px] h-[76px] flex-shrink-0 ">
                  <img 
                    src={`${API_BASE_URL}${post.BlogPostPicture.formats.thumbnail.url}`}
                    alt={post.BlogPostPicture.alternativeText || post.Title}
                    class="w-full h-full object-cover rounded-lg"
                  />
                </div>
                <div style="font-size: 12px;">
                  <p class="font-helvetica" style="color:#27486d;font-weight:700;">{post.BlogPostTitle}</p>
                  <p class="font-helvetica" style="color:#27486d;font-weight:400;">{post.BlogPostDescription}</p>
                </div>
              </div>
            ))}
          </div>
        </div>
      </div>
      
      <!-- 2nd column: video -->
      <div class="h-[620px] xl:w-2/3 w-full relative overflow-hidden rounded-xl">
        <video 
          
          loop 
          muted 
          playsinline
          class="absolute inset-0 h-full w-auto object-cover"
          poster=""
        >
          <source src={`${API_BASE_URL}${autoplay_video.url}`} type="video/mp4">
        </video>
      </div>
    </div>
  </div>
</section>